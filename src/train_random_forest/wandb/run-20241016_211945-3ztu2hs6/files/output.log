2024-10-16 21:19:50,548 Minimum price: 10, Maximum price: 350
2024-10-16 21:19:50,581 Preparing sklearn pipeline
2024-10-16 21:19:50,582 Fitting
2024-10-16 21:22:14,047 Scoring
2024-10-16 21:22:14,727 Score: 0.5340342040659455
2024-10-16 21:22:14,729 MAE: 33.54348026315789
2024-10-16 21:22:14,730 Exporting model
Traceback (most recent call last):
  File "/home/lhan/Project-Build-an-ML-Pipeline-Starter/src/train_random_forest/run.py", line 304, in <module>
    go(args)
  File "/home/lhan/Project-Build-an-ML-Pipeline-Starter/src/train_random_forest/run.py", line 105, in go
    signature = mlflow.models.infer_signature(X_val[processed_features], y_pred)
  File "/home/lhan/miniconda3/envs/mlflow-211c8fb974d6215abb361efdc7b6c4bd9a3e8dfd/lib/python3.10/site-packages/mlflow/models/signature.py", line 212, in infer_signature
    inputs = _infer_schema(model_input) if model_input is not None else None
  File "/home/lhan/miniconda3/envs/mlflow-211c8fb974d6215abb361efdc7b6c4bd9a3e8dfd/lib/python3.10/site-packages/mlflow/types/utils.py", line 135, in _infer_schema
    [ColSpec(type=_infer_pandas_column(data[col]), name=col) for col in data.columns]
  File "/home/lhan/miniconda3/envs/mlflow-211c8fb974d6215abb361efdc7b6c4bd9a3e8dfd/lib/python3.10/site-packages/mlflow/types/utils.py", line 135, in <listcomp>
    [ColSpec(type=_infer_pandas_column(data[col]), name=col) for col in data.columns]
  File "/home/lhan/miniconda3/envs/mlflow-211c8fb974d6215abb361efdc7b6c4bd9a3e8dfd/lib/python3.10/site-packages/mlflow/types/utils.py", line 293, in _infer_pandas_column
    raise MlflowException(
mlflow.exceptions.MlflowException: Unable to map 'object' type to MLflow DataType. object can be mapped iff all values have identical data type which is one of (string, (bytes or byterray),  int, float).
****** x_val data types
id                                  int64
name                               object
host_id                             int64
host_name                          object
neighbourhood_group                object
neighbourhood                      object
latitude                          float64
longitude                         float64
room_type                          object
minimum_nights                      int64
number_of_reviews                   int64
last_review                        object
reviews_per_month                 float64
calculated_host_listings_count      int64
availability_365                    int64
dtype: object
******